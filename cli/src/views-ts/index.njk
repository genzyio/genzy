// Auto-generated by Nimbly Client CLI
import { Nimble{% if isServer %}, NimblyApi{% endif %} } from '@n1mbly/{% if isServer %}api{% else %}client{% endif %}';
{% for service in services %}import { {{ service.name }} as {{service.name}}Local } from './{{ service.name }}';
{% endfor %}

export type NimbleServices = {
  {% for service in services %}{{ service.name.charAt(0).toLowerCase() + service.name.slice(1) }}: {{ service.name }}Local;
  {% endfor %}
};

{% if host %}const host = "{{ host }}";{% endif %}

const nimble = new Nimble()
{% for service in services %}
{% if host %}.addRemoteService(host, {{ service.name }}Local){% else %}.addLocalService({{ service.name }}Local){% endif %}
{% endfor %};

export const {
  {% for service in services %}{{ service.name.charAt(0).toLowerCase() + service.name.slice(1) }},
  {% endfor %}
}: NimbleServices = nimble.getAllServices();

{% if isServer %}
const app = new NimblyApi().from(nimble);

app.listen(3000, () => console.log("App is listening on port 3000"));
{% endif %}