// Auto-generated by N1mbly Client CLI
import {
  {% if path != null %}Controller,{% endif %}
  Get,
  Post,
  Put,
  Delete,
  Query,
  Path,
  Body,
  Returns,
  ReturnsArrayOf,
  string, int, float, boolean, type, arrayOf
} from '@n1mbly/api';
{% for name, fields in types %}
import { {{name}} } from "./types/{{name}}";
{% endfor %}
{% if extends %}
import {
{{extends}}
} from "./{{extends}}";
{% endif %}
{% if dependencies | length %}
import { N1mblyControllersContainerDeps } from ".";
{% endif %}

{% if path != null %}@Controller('{{ path }}'){% endif %}
export class {{ name }} {% if extends %} extends {{ extends }} {% endif %} {
{% if dependencies | length %}
  {% for dependency in dependencies %}
    private {{dependency}}: N1mblyControllersContainerDeps["services"]["{{dependency}}"];
  {% endfor %}
  constructor(deps: N1mblyControllersContainerDeps) {
  {% for dependency in dependencies %}
    this.{{dependency}} = deps.services.{{dependency}};
  {% endfor %}
  }
{% endif %}
{% for action in actions %} {{ methods }}
{% if action.httpMethod %}  @{{ action.httpMethod }}({% if action.httpMethod %}'{{ action.path }}'{% endif %}){% endif %}
  {% if action.resultDecorator %}{{ action.resultDecorator | safe }}{% endif %}
  async {{ action.name }}({% for param in action.params %}
    {% if param.source == "query" %}
      @Query('{{ param.name }}', { {% if param.typeAdapted.name != "any" %}type: {% if param.typeAdapted.isComplex %} {{ param.typeAdapted.name }} {% else %} "{{ param.type.type }}" {% endif %}, {% endif %} {% if param.$isOptional %}optional: true {% endif %} {% if param.$isArray %}, array: true {% endif %}})
    {% endif %}
    {% if param.source == "path" %}
      @Path('{{ param.name }}', { {% if param.typeAdapted.name != "any" %}type: {% if param.typeAdapted.isComplex %} {{ param.typeAdapted.name }} {% else %} "{{ param.type.type }}" {% endif %}, {% endif %} {% if param.$isOptional %}optional: true {% endif %} {% if param.$isArray %}, array: true {% endif %}})
    {% endif %}
    {% if param.source == "body" %}
      @Body({ {% if param.typeAdapted.name != "any" %}type: {{ param.typeAdapted.name }}, {% endif %} {% if param.$isOptional %}optional: true {% endif %} {% if param.$isArray %}, array: true {% endif %}})
    {% endif %} {{ param.name }}{% if param.$isOptional %}?{% endif %}: {{ param.typeAdapted.name }}{% if param.$isArray %}[]{% endif %}{% if not loop.last %}, {% endif %}{% endfor %}): Promise<{{ action.resultType.name }}{% if action.result.$isArray %}[]{% endif %}>
  {% if action.existingBody %}
    {{ action.existingBody | safe }}
  {% else %}
    {
      // @ts-ignore
      return null;
    }
  {% endif %}
{% endfor %}

{% for existingMethod in existingMethodsNotInMeta %}
  {{ existingMethod | safe }}
{% endfor %}
}
